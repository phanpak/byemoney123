---
// Premium custom cursor with gold accent
---

<div class="cursor" id="cursor" aria-hidden="true">
  <div class="cursor-dot"></div>
  <div class="cursor-ring"></div>
  <div class="cursor-text"></div>
</div>

<!-- Gold Particle Trail Container -->
<div class="cursor-trail" id="cursor-trail" aria-hidden="true"></div>

<style>
  .cursor {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 9999;
  }

  .cursor-dot {
    position: absolute;
    width: 6px;
    height: 6px;
    background: var(--color-gold);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: transform 0.15s var(--ease-out-expo), opacity 0.2s ease;
  }

  .cursor-ring {
    position: absolute;
    width: 48px;
    height: 48px;
    border: 1px solid rgba(201, 162, 39, 0.4);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition:
      width 0.4s var(--ease-out-expo),
      height 0.4s var(--ease-out-expo),
      border-color 0.3s ease,
      background 0.3s ease,
      opacity 0.2s ease;
  }

  .cursor-text {
    position: absolute;
    transform: translate(-50%, -50%);
    font-family: var(--font-body);
    font-size: 0.6875rem;
    font-weight: 500;
    color: var(--color-cream);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }

  /* Hover states */
  .cursor.hovering .cursor-ring {
    width: 80px;
    height: 80px;
    background: rgba(201, 162, 39, 0.08);
    border-color: rgba(201, 162, 39, 0.6);
  }

  .cursor.hovering .cursor-dot {
    transform: translate(-50%, -50%) scale(0);
  }

  /* View text state (for cards) */
  .cursor.view .cursor-ring {
    width: 100px;
    height: 100px;
    background: var(--color-gold);
    border-color: var(--color-gold);
  }

  .cursor.view .cursor-dot {
    opacity: 0;
  }

  .cursor.view .cursor-text {
    opacity: 1;
    color: var(--color-bg);
  }

  /* Click state */
  .cursor.clicking .cursor-ring {
    width: 36px;
    height: 36px;
  }

  /* Hidden state */
  .cursor.hidden {
    opacity: 0;
  }

  /* Hide on touch devices */
  @media (hover: none) {
    .cursor {
      display: none;
    }
  }

  /* Hide default cursor on desktop */
  @media (hover: hover) {
    :global(html) {
      cursor: none !important;
    }

    :global(a, button, [data-magnetic], input, textarea, select) {
      cursor: none !important;
    }
  }

  /* Cursor Trail Container */
  .cursor-trail {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9997;
  }

  /* Individual Trail Particles */
  :global(.cursor-particle) {
    position: fixed;
    width: 4px;
    height: 4px;
    background: var(--color-gold);
    border-radius: 50%;
    pointer-events: none;
    animation: cursorParticleFade 0.6s ease-out forwards;
    box-shadow: 0 0 6px var(--color-gold), 0 0 10px rgba(201, 162, 39, 0.4);
  }

  /* Larger particles when hovering products */
  :global(.cursor-particle.intense) {
    width: 6px;
    height: 6px;
    animation: cursorParticleFadeIntense 0.8s ease-out forwards;
  }

  @keyframes cursorParticleFade {
    0% {
      opacity: 0.7;
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(0.3) translateY(8px);
    }
  }

  @keyframes cursorParticleFadeIntense {
    0% {
      opacity: 0.9;
      transform: scale(1.2);
    }
    100% {
      opacity: 0;
      transform: scale(0.2) translateY(15px);
    }
  }

  /* Light theme adjustments */
  :global([data-theme="light"] .cursor-particle) {
    background: var(--color-gold);
    box-shadow: 0 0 6px var(--color-gold), 0 0 10px rgba(184, 148, 31, 0.5);
  }

  /* Disable trail on touch devices and reduced motion */
  @media (hover: none) {
    .cursor-trail {
      display: none;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .cursor-trail {
      display: none;
    }
  }
</style>

<script>
  const cursor = document.getElementById('cursor');
  const cursorDot = cursor?.querySelector('.cursor-dot') as HTMLElement;
  const cursorRing = cursor?.querySelector('.cursor-ring') as HTMLElement;
  const cursorText = cursor?.querySelector('.cursor-text') as HTMLElement;
  const cursorTrail = document.getElementById('cursor-trail');

  if (cursor && cursorDot && cursorRing && cursorText) {
    let mouseX = 0;
    let mouseY = 0;
    let dotX = 0;
    let dotY = 0;
    let ringX = 0;
    let ringY = 0;
    let isIntense = false; // For product hover state

    // Particle trail system
    const particles: HTMLElement[] = [];
    const MAX_PARTICLES = 15;
    let lastParticleTime = 0;
    const PARTICLE_INTERVAL = 40; // ms between particles

    const spawnParticle = () => {
      if (!cursorTrail) return;

      const now = Date.now();
      if (now - lastParticleTime < PARTICLE_INTERVAL) return;
      lastParticleTime = now;

      // Remove oldest particle if at max
      if (particles.length >= MAX_PARTICLES) {
        const oldest = particles.shift();
        oldest?.remove();
      }

      const particle = document.createElement('div');
      particle.className = isIntense ? 'cursor-particle intense' : 'cursor-particle';
      particle.style.left = `${mouseX}px`;
      particle.style.top = `${mouseY}px`;

      // Slight random offset for organic feel
      const offsetX = (Math.random() - 0.5) * 4;
      const offsetY = (Math.random() - 0.5) * 4;
      particle.style.transform = `translate(${offsetX}px, ${offsetY}px)`;

      cursorTrail.appendChild(particle);
      particles.push(particle);

      // Auto-remove after animation completes
      setTimeout(() => {
        const index = particles.indexOf(particle);
        if (index > -1) particles.splice(index, 1);
        particle.remove();
      }, isIntense ? 800 : 600);
    };

    // Smooth cursor following with GSAP-like interpolation
    const animate = () => {
      // Dot follows faster (more responsive)
      dotX += (mouseX - dotX) * 0.35;
      dotY += (mouseY - dotY) * 0.35;

      // Ring follows slower (trailing effect)
      ringX += (mouseX - ringX) * 0.12;
      ringY += (mouseY - ringY) * 0.12;

      cursorDot.style.left = `${dotX}px`;
      cursorDot.style.top = `${dotY}px`;
      cursorRing.style.left = `${ringX}px`;
      cursorRing.style.top = `${ringY}px`;
      cursorText.style.left = `${ringX}px`;
      cursorText.style.top = `${ringY}px`;

      // Spawn particle trail
      spawnParticle();

      requestAnimationFrame(animate);
    };

    animate();

    // Track mouse position
    document.addEventListener('mousemove', (e) => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    // Interactive elements hover
    const interactiveElements = document.querySelectorAll('a, button, [data-magnetic], input, textarea, select');

    interactiveElements.forEach(el => {
      el.addEventListener('mouseenter', () => {
        cursor.classList.add('hovering');
      });

      el.addEventListener('mouseleave', () => {
        cursor.classList.remove('hovering');
      });
    });

    // Product cards - show "View" text + intense trail
    const productCards = document.querySelectorAll('.product-card .card-inner');

    productCards.forEach(card => {
      card.addEventListener('mouseenter', () => {
        cursor.classList.add('view');
        cursorText.textContent = 'View';
        isIntense = true; // Intensify particle trail
      });

      card.addEventListener('mouseleave', () => {
        cursor.classList.remove('view');
        isIntense = false;
      });
    });

    // External links - show "Open" text
    const externalLinks = document.querySelectorAll('a[target="_blank"]');

    externalLinks.forEach(link => {
      link.addEventListener('mouseenter', () => {
        cursor.classList.remove('hovering');
        cursor.classList.add('view');
        cursorText.textContent = 'Open';
      });

      link.addEventListener('mouseleave', () => {
        cursor.classList.remove('view');
      });
    });

    // Click effect
    document.addEventListener('mousedown', () => {
      cursor.classList.add('clicking');
    });

    document.addEventListener('mouseup', () => {
      cursor.classList.remove('clicking');
    });

    // Hide when leaving window
    document.addEventListener('mouseleave', () => {
      cursor.classList.add('hidden');
    });

    document.addEventListener('mouseenter', () => {
      cursor.classList.remove('hidden');
    });
  }
</script>
