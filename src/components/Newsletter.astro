---
// Newsletter section with dramatic visual impact
---

<section class="newsletter" data-animate>
  <!-- Background elements -->
  <div class="newsletter-bg" aria-hidden="true">
    <div class="newsletter-grid"></div>
    <div class="newsletter-glow newsletter-glow--1"></div>
    <div class="newsletter-glow newsletter-glow--2"></div>
    <div class="newsletter-grain"></div>
  </div>

  <!-- Content -->
  <div class="newsletter-content">
    <!-- Label -->
    <span class="newsletter-label">Stay Updated</span>

    <!-- Main headline -->
    <h2 class="newsletter-title">
      <span class="newsletter-title-line">The Best Products</span>
      <span class="newsletter-title-line">
        <span class="newsletter-title-word">In Your</span>
        <span class="newsletter-title-word newsletter-title-word--accent">Inbox</span>
      </span>
    </h2>

    <!-- Subtitle -->
    <p class="newsletter-subtitle">
      Obsessively curated. La crème de la crème.
      <br />
      No spam, just exceptional finds.
    </p>

    <!-- Form -->
    <form class="newsletter-form" data-newsletter-form>
      <div class="form-wrapper">
        <div class="input-group">
          <input
            type="email"
            name="email"
            placeholder="name@email.com"
            required
            class="newsletter-input"
            aria-label="Email address"
          />
          <div class="input-border"></div>
        </div>
        <button type="submit" class="newsletter-submit" data-magnetic>
          <span class="submit-text">Subscribe</span>
          <span class="submit-icon">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <path d="M4 9H14M14 9L10 5M14 9L10 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
        </button>
      </div>
      <p class="form-note">Join 2,000+ design enthusiasts</p>
    </form>
  </div>

  <!-- Decorative corner elements -->
  <div class="newsletter-corner newsletter-corner--tl" aria-hidden="true"></div>
  <div class="newsletter-corner newsletter-corner--tr" aria-hidden="true"></div>
  <div class="newsletter-corner newsletter-corner--bl" aria-hidden="true"></div>
  <div class="newsletter-corner newsletter-corner--br" aria-hidden="true"></div>
</section>

<style>
  .newsletter {
    position: relative;
    margin: 6rem 2rem;
    padding: clamp(4rem, 10vw, 8rem) clamp(2rem, 5vw, 4rem);
    background: var(--color-bg-elevated);
    border-radius: var(--radius-xl);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }

  /* Background elements */
  .newsletter-bg {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .newsletter-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(245, 240, 232, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(245, 240, 232, 0.03) 1px, transparent 1px);
    background-size: 60px 60px;
    mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse at center, black 0%, transparent 70%);
  }

  .newsletter-glow {
    position: absolute;
    border-radius: 50%;
    filter: blur(120px);
    pointer-events: none;
  }

  .newsletter-glow--1 {
    width: 600px;
    height: 600px;
    background: var(--color-gold-muted);
    top: -200px;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0.6;
    /* Breathing animation - like a heartbeat */
    animation: glowBreathe 4s ease-in-out infinite;
  }

  .newsletter-glow--2 {
    width: 400px;
    height: 400px;
    background: rgba(201, 162, 39, 0.1);
    bottom: -150px;
    right: -100px;
    opacity: 0.5;
    /* Offset breathing for organic feel */
    animation: glowBreathe 4s ease-in-out infinite;
    animation-delay: -2s;
  }

  @keyframes glowBreathe {
    0%, 100% {
      opacity: 0.3;
      transform: translateX(-50%) scale(1);
    }
    50% {
      opacity: 0.6;
      transform: translateX(-50%) scale(1.05);
    }
  }

  /* Second glow has different transform origin */
  .newsletter-glow--2 {
    animation-name: glowBreathe2;
  }

  @keyframes glowBreathe2 {
    0%, 100% {
      opacity: 0.3;
      transform: scale(1);
    }
    50% {
      opacity: 0.55;
      transform: scale(1.08);
    }
  }

  .newsletter-grain {
    position: absolute;
    inset: -50%;
    width: 200%;
    height: 200%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.03;
    mix-blend-mode: overlay;
    pointer-events: none;
  }

  /* Corner decorations */
  .newsletter-corner {
    position: absolute;
    width: 40px;
    height: 40px;
    border: 1px solid rgba(201, 162, 39, 0.2);
  }

  .newsletter-corner--tl {
    top: 1.5rem;
    left: 1.5rem;
    border-right: none;
    border-bottom: none;
  }

  .newsletter-corner--tr {
    top: 1.5rem;
    right: 1.5rem;
    border-left: none;
    border-bottom: none;
  }

  .newsletter-corner--bl {
    bottom: 1.5rem;
    left: 1.5rem;
    border-right: none;
    border-top: none;
  }

  .newsletter-corner--br {
    bottom: 1.5rem;
    right: 1.5rem;
    border-left: none;
    border-top: none;
  }

  /* Content */
  .newsletter-content {
    position: relative;
    z-index: 1;
    max-width: 600px;
  }

  .newsletter-label {
    display: inline-block;
    font-family: var(--font-body);
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--color-gold);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 1.5rem;
    padding: 0.5rem 1rem;
    background: var(--color-gold-muted);
    border-radius: var(--radius-full);
  }

  .newsletter-title {
    font-family: var(--font-display);
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 600;
    color: var(--color-cream);
    line-height: 1.1;
    letter-spacing: -0.03em;
    margin-bottom: 1.5rem;
  }

  .newsletter-title-line {
    display: block;
  }

  .newsletter-title-word {
    display: inline-block;
  }

  .newsletter-title-word--accent {
    color: var(--color-gold);
  }

  .newsletter-subtitle {
    font-family: var(--font-body);
    font-size: 1rem;
    color: var(--color-text-muted);
    line-height: 1.7;
    margin-bottom: 2.5rem;
  }

  /* Form */
  .newsletter-form {
    width: 100%;
  }

  .form-wrapper {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .input-group {
    flex: 1;
    position: relative;
  }

  .newsletter-input {
    width: 100%;
    padding: 1rem 1.5rem;
    background: var(--color-surface);
    border: 1px solid rgba(245, 240, 232, 0.08);
    border-radius: var(--radius-lg);
    font-family: var(--font-body);
    font-size: 0.9375rem;
    color: var(--color-cream);
    outline: none;
    transition: all 0.3s ease;
  }

  .newsletter-input::placeholder {
    color: var(--color-text-subtle);
  }

  .newsletter-input:focus {
    border-color: var(--color-gold);
    box-shadow: 0 0 0 3px var(--color-gold-muted);
  }

  .input-border {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--color-gold), var(--color-gold-light));
    transform: scaleX(0);
    transition: transform 0.4s var(--ease-out-expo);
    border-radius: 0 0 var(--radius-lg) var(--radius-lg);
  }

  .newsletter-input:focus ~ .input-border {
    transform: scaleX(1);
  }

  .newsletter-submit {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    background: var(--color-gold);
    border-radius: var(--radius-lg);
    color: var(--color-bg);
    font-family: var(--font-body);
    font-size: 0.9375rem;
    font-weight: 600;
    white-space: nowrap;
    transition: all 0.4s var(--ease-out-expo);
  }

  .newsletter-submit:hover {
    background: var(--color-gold-light);
    transform: translateY(-2px);
    box-shadow: 0 10px 30px -10px rgba(201, 162, 39, 0.4);
  }

  .newsletter-submit:active {
    transform: translateY(0);
  }

  .submit-icon {
    display: flex;
    transition: transform 0.3s var(--ease-out-expo);
  }

  .newsletter-submit:hover .submit-icon {
    transform: translateX(4px);
  }

  .form-note {
    font-family: var(--font-body);
    font-size: 0.8125rem;
    color: var(--color-text-subtle);
  }

  /* Success state */
  .newsletter-form.success .form-wrapper {
    opacity: 0;
    transform: translateY(-10px);
    pointer-events: none;
  }

  .newsletter-form.success::after {
    content: 'Thanks for subscribing!';
    display: block;
    font-family: var(--font-display);
    font-size: 1.5rem;
    color: var(--color-gold);
    animation: successReveal 0.6s var(--ease-out-expo) forwards;
  }

  @keyframes successReveal {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Confetti animation */
  :global(.confetti-particle) {
    animation: confettiFall 1.2s ease-out forwards !important;
  }

  @keyframes confettiFall {
    0% {
      opacity: 1;
      transform: translate(0, 0) rotate(0deg) scale(1);
    }
    100% {
      opacity: 0;
      transform: translate(var(--vx, 0), calc(var(--vy, 0) + 200px)) rotate(var(--rotation, 360deg)) scale(0.5);
    }
  }

  /* Responsive */
  @media (max-width: 640px) {
    .newsletter {
      margin: 4rem 1rem;
      padding: 3rem 1.5rem;
    }

    .form-wrapper {
      flex-direction: column;
    }

    .newsletter-submit {
      width: 100%;
      justify-content: center;
    }

    .newsletter-corner {
      width: 24px;
      height: 24px;
    }
  }
</style>

<script>
  // Form handling with animation
  const form = document.querySelector('[data-newsletter-form]');
  const newsletterSection = document.querySelector('.newsletter');

  // Gold confetti burst on success
  const spawnConfetti = () => {
    if (!newsletterSection) return;

    const colors = ['#c9a227', '#e8c547', '#f5f0e8'];
    const particleCount = 30;

    for (let i = 0; i < particleCount; i++) {
      const particle = document.createElement('div');
      particle.className = 'confetti-particle';

      // Random starting position near center
      const startX = 50 + (Math.random() - 0.5) * 20;
      const startY = 50 + (Math.random() - 0.5) * 10;

      // Random velocity
      const velocityX = (Math.random() - 0.5) * 200;
      const velocityY = -Math.random() * 150 - 50;

      // Random rotation
      const rotation = Math.random() * 360;

      // Random size
      const size = 4 + Math.random() * 6;

      // Random color
      const color = colors[Math.floor(Math.random() * colors.length)];

      particle.style.cssText = `
        position: absolute;
        left: ${startX}%;
        top: ${startY}%;
        width: ${size}px;
        height: ${size}px;
        background: ${color};
        border-radius: ${Math.random() > 0.5 ? '50%' : '2px'};
        pointer-events: none;
        z-index: 100;
        --vx: ${velocityX}px;
        --vy: ${velocityY}px;
        --rotation: ${rotation}deg;
        animation: confettiFall 1.2s ease-out forwards;
        box-shadow: 0 0 6px ${color};
      `;

      newsletterSection.appendChild(particle);

      // Remove after animation
      setTimeout(() => particle.remove(), 1200);
    }
  };

  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(e.target as HTMLFormElement);
    const email = formData.get('email');

    console.log('Newsletter signup:', email);

    // Add success state
    form.classList.add('success');

    // Spawn confetti burst
    spawnConfetti();

    // Reset after delay
    setTimeout(() => {
      form.classList.remove('success');
      (e.target as HTMLFormElement).reset();
    }, 3000);
  });
</script>
